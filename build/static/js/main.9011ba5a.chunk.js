(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{36:function(e,t,n){},37:function(e,t,n){},66:function(e,t,n){"use strict";n.r(t);var a=n(1),c=n.n(a),r=n(29),s=n.n(r),i=(n(36),n(37),n(14)),o=n(2),l=n(8),u=n(9),f=n(11),h=n(10);function j(e,t,n){if(e>255||t>255||n>255)throw"Invalid color component";return(e<<16|t<<8|n).toString(16)}var d=n(17),v=n.n(d),b=n(30),p=n(18),g=n.n(p);function O(){return(O=Object(b.a)(v.a.mark((function e(){var t;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"/api/generate/kat",e.next=3,g.a.get("/api/generate/kat");case 3:return t=e.sent,console.log("generate cat response status",t.status),e.abrupt("return",t.data);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var m=n(0),x=function(e){Object(f.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).canvasRef=c.a.createRef(),a.imgRef=c.a.createRef(),a.state={file:"",imagePreviewUrl:"",colorMap:{},placement:"",subType:""},a}return Object(u.a)(n,[{key:"componentDidMount",value:function(){this.imgRef}},{key:"_generateCanvas",value:function(){var e=this;return Object(m.jsx)("div",{children:Object(m.jsx)("canvas",{onMouseMove:function(t){return e._handleFindPosition(t)},ref:this.canvasRef,width:240,height:240})})}},{key:"_scanCanvas",value:function(){var e=this.canvasRef,t={};(function(e){for(var t=function(e){for(var t=[],n=0;n<e;n++)t.push([]);return t}(24),n=e.getContext("2d"),a=0;a<24;a++)for(var c=0;c<24;c++){var r=10*c,s=10*a,i=n.getImageData(r,s,9,9).data,o="#"+("000000"+j(i[0],i[1],i[2])).slice(-6);switch(o){case"#000000":t[a][c]="outline";break;case"#ffffff":t[a][c]="empty";break;default:t[a][c]="color_".concat(o)}}return t})(e.current).forEach((function(e,n){t[n]=e})),this.setState({colorMap:t}),console.log(t)}},{key:"_saveAccessory",value:function(){""!==this.state.placement&&""!==this.state.subtype&&this.state.colorMap!=={}?function(e,t,n){var a="".concat("","/accessory/create");window.confirm("Are you sure you eant to save this accessory as sub type ".concat(t," and placement ").concat(e))&&g.a.post(a,{placement:e,subType:t,accessory:n})}(this.state.placement,this.state.subType,this.state.colorMap):alert("unable to save accessory plz review configuration")}},{key:"_handlePlacementChange",value:function(e){this.setState({placement:e.target.value})}},{key:"_handleSubTypeChange",value:function(e){this.setState({subType:e.target.value})}},{key:"_handleSubmit",value:function(e){e.preventDefault(),console.log("handle uploading-",this.state.file)}},{key:"_handleFindPosition",value:function(e){var t=this.canvasRef,n=t.current.getContext("2d"),a=function(e){var t=0,n=0;if(e.offsetParent){do{t+=e.offsetLeft,n+=e.offsetTop}while(e=e.offsetParent);return{x:t,y:n}}}(t.current),c=e.pageX-a.x,r=e.pageY-a.y,s=n.getImageData(c,r,10,10).data,i="#"+("000000"+j(s[0],s[1],s[2])).slice(-6);console.log(i)}},{key:"_handleImageChange",value:function(e){var t=this;e.preventDefault();var n=new FileReader,a=e.target.files[0];n.onloadstart=function(e){t.canvasRef.current.getContext("2d").clearRect(0,0,240,240)},n.onloadend=function(e){t.setState({file:a,imagePreviewUrl:n.result,colorMap:{},placement:"",subType:""});var c=new Image;c.onload=function(e){var n=t.canvasRef.current.getContext("2d");n.fillStyle="white",n.fillRect(0,0,240,240),n.drawImage(c,0,0,240,240)},c.src=t.state.imagePreviewUrl},n.readAsDataURL(a)}},{key:"render",value:function(){var e=this,t=this.state.imagePreviewUrl,n=null;return t?Object(m.jsxs)("div",{className:"previewComponent",children:[Object(m.jsx)("form",{onSubmit:function(t){return e._handleSubmit(t)},children:Object(m.jsx)("input",{className:"fileInput",type:"file",onChange:function(t){return e._handleImageChange(t)}})}),Object(m.jsx)("div",{className:"imgPreview",children:Object(m.jsx)("img",{ref:this.imgRef,height:240,width:240,alt:"img",src:t})}),Object(m.jsx)("br",{}),Object(m.jsx)("h4",{children:"Canvas"}),this._generateCanvas(),Object(m.jsx)("br",{}),Object(m.jsx)("button",{onClick:function(){return e._scanCanvas()},children:"scan"}),Object(m.jsx)("br",{}),Object(m.jsxs)("form",{id:"save-accessory",children:[Object(m.jsx)("label",{children:"enter subtype"}),Object(m.jsx)("input",{className:"subtype-input",type:"text",value:this.state.subType,onChange:function(t){return e._handleSubTypeChange(t)}}),Object(m.jsx)("br",{}),Object(m.jsx)("label",{children:"choose placement"}),Object(m.jsxs)("select",{value:this.state.placement,onChange:function(t){return e._handlePlacementChange(t)},children:[Object(m.jsx)("option",{value:"",children:"Select your option"}),["top","mid","bottom","custom"].map((function(e,t){return Object(m.jsx)("option",{value:e,children:e},"".concat(t,"_option"))}))]})]}),Object(m.jsx)("button",{onClick:function(t){return e._saveAccessory(t)},children:"Save Accessory"})]}):(n=Object(m.jsx)("div",{className:"previewText",children:"Please select an Image for Preview"}),Object(m.jsxs)("div",{className:"previewComponent",children:[Object(m.jsx)("form",{onSubmit:function(t){return e._handleSubmit(t)},children:Object(m.jsx)("input",{className:"fileInput",type:"file",onChange:function(t){return e._handleImageChange(t)}})}),Object(m.jsx)("div",{className:"imgPreview",children:n}),Object(m.jsx)("h4",{children:"Canvas"}),this._generateCanvas()]}))}}]),n}(c.a.Component),y=function(e){Object(f.a)(n,e);var t=Object(h.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"render",value:function(){return Object(m.jsxs)("div",{children:[Object(m.jsx)("h1",{children:"Create Accessory"}),Object(m.jsx)(x,{})]})}}]),n}(c.a.Component);function C(e,t){if(!e)return[];for(var n={empty:"#ffffff",outline:"#000000"},a=t,c=0;c<24;c++){e[c].forEach((function(e){if(a.length||n.hasOwnProperty(e)||(n[e]="#".concat(Math.floor(16777215*Math.random()).toString(16))),n.hasOwnProperty(e));else{var t=k(a);n[e]="#".concat(a[t]),a.splice(t,1)}}))}return function(e,t){for(var n=[],a=0;a<24;a++){var c=e[a].map((function(e){return t[e]}));n.push(c)}return n}(e,n)}function k(e){var t=e.length;return Math.floor(Math.random()*t)}function w(e,t){if(t.length<24)return e;for(var n=e,a=0;a<e.length;a++)for(var c=0;c<e.length;c++)"#ffffff"!=t[a][c]&&(n[a][c]=t[a][c]);return n}var _=function(e){Object(f.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).canvasRef=c.a.createRef(),a.state={Face:{},Accessories:{},Background:{},Merged:null,ImgData:null},a}return Object(u.a)(n,[{key:"_generateKat",value:function(e){var t=this;e.preventDefault(),function(){return O.apply(this,arguments)}().then((function(e){console.log("data in promise",e),t.setState({Face:e.face,Accessories:e.accessories,Background:e.background});var n=C(t.state.Face.face.Face,t.state.Face.palette.palette),a=function(e){for(var t=[],n=0;n<24;n++)t.push(e[n]);return t}(t.state.Background.background.Background),c={};Object.keys(t.state.Accessories).forEach((function(e){t.state.Accessories[e]&&(c[e]=C(t.state.Accessories[e].accessory.accessory,t.state.Accessories[e].palette.palette))}));var r=w(a,n),s=Object.values(c).reduce((function(e,t){return w(e,t)})),i=w(r,s);!function(e,t){for(var n=0;n<24;n++)for(var a=0;a<24;a++){"#ffffff"===e[n][a]?t.fillStyle="#ffffff":t.fillStyle=e[n][a];var c=10*a,r=10*n;t.fillRect(c,r,10,10)}}(i,t.canvasRef.current.getContext("2d"));var o=t.canvasRef.current.toDataURL("image/png");console.log("converted image data",o),t.setState({Merged:i,ImgData:o})}))}},{key:"_generateCanvas",value:function(){return Object(m.jsx)("div",{children:Object(m.jsx)("canvas",{ref:this.canvasRef,width:240,height:240})})}},{key:"render",value:function(){var e=this;return Object(m.jsxs)("div",{children:[Object(m.jsx)("button",{onClick:function(t){return e._generateKat(t)},children:"Generate Kat"}),this._generateCanvas(),Object(m.jsx)("br",{}),this.state.Merged&&this.state.ImgData?Object(m.jsx)("a",{href:this.state.ImgData,download:!0,children:"Download Kat"}):null]})}}]),n}(c.a.Component),R=function(e){Object(f.a)(n,e);var t=Object(h.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"render",value:function(){return Object(m.jsxs)("div",{children:[Object(m.jsx)("h1",{children:"Generate Kat"}),Object(m.jsx)(_,{})]})}}]),n}(c.a.Component);function S(){return Object(m.jsx)("h2",{children:"Home"})}var P=function(){return Object(m.jsx)(i.a,{children:Object(m.jsxs)("div",{children:[Object(m.jsx)("nav",{children:Object(m.jsxs)("ul",{children:[Object(m.jsx)("li",{children:Object(m.jsx)(i.b,{to:"/",children:"Home"})}),Object(m.jsx)("li",{children:Object(m.jsx)(i.b,{to:"/create/accessory",children:"Create Accessory"})}),Object(m.jsx)("li",{children:Object(m.jsx)(i.b,{to:"/generate/kat",children:"Create Kat"})})]})}),Object(m.jsxs)(o.c,{children:[Object(m.jsx)(o.a,{path:"/generate/kat",children:Object(m.jsx)(R,{})}),Object(m.jsx)(o.a,{path:"/create/accessory",children:Object(m.jsx)(y,{})}),Object(m.jsx)(o.a,{path:"/",children:Object(m.jsx)(S,{})})]})]})})},I=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,67)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,r=t.getLCP,s=t.getTTFB;n(e),a(e),c(e),r(e),s(e)}))};s.a.render(Object(m.jsx)(c.a.StrictMode,{children:Object(m.jsx)(P,{})}),document.getElementById("root")),I()}},[[66,1,2]]]);
//# sourceMappingURL=main.9011ba5a.chunk.js.map